{% extends 'movies/base.html' %}

{% block title %}Login{% endblock %}

{% block content %}

<div class="row justify-content-center">

    <div class="col-md-6">

        <h2 class="mb-4">Login</h2>

        <!-- Login Form -->
        <form method="post">

            {% csrf_token %}

            {{ form.as_p }}

            <button type="submit" class="btn btn-success">Login</button>

        </form>

        <!-- Link to registration page if not already registered -->
        <p class="mt-3">Don't have an account?

            <a href="{% url 'movies:register' %}">Register here</a>.

        </p>

    </div>

</div>

{% endblock %}

<!-- Incorrect Log In Modal -->
{{% block extra_js %}

  {% if login_failed %}

    <!-- Login Failed Modal -->
    <div class="modal fade" id="loginFailedModal" tabindex="-1" aria-labelledby="loginFailedModalLabel" aria-hidden="true">

      <div class="modal-dialog modal-dialog-centered">

        <div class="modal-content border-danger">

          <div class="modal-header bg-danger text-white">

            <h5 class="modal-title">Login Failed</h5>

            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

          </div>

          <div class="modal-body">

            Incorrect username or password. Please try again.

          </div>

        </div>

      </div>

    </div>

    <script>

      const loginFailedModal = new bootstrap.Modal(document.getElementById('loginFailedModal'));
      loginFailedModal.show();

    </script>

  {% endif %}

    <!-- Registration Success Modal -->
  {% if registered %}

    <!-- ✅ Registration Success Modal -->
    <div class="modal fade" id="registeredModal" tabindex="-1" aria-labelledby="registeredModalLabel" aria-hidden="true">

      <div class="modal-dialog modal-dialog-centered">

        <div class="modal-content border-success">

          <div class="modal-header bg-success text-white">

            <h5 class="modal-title" id="registeredModalLabel">Registration Complete</h5>

            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

          </div>

          <div class="modal-body">

            ✅ Registration successful! You can now log in.

          </div>

        </div>

      </div>

    </div>

    <script>

      const registeredModal = new bootstrap.Modal(document.getElementById('registeredModal'));
      registeredModal.show();

    </script>

  {% endif %}

{% endblock %}